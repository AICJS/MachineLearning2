library(ggplot2)

train_data <- read.csv("C:/Users/PC502/Desktop/simple_train_2.csv")

ggplot(train_data, aes(x = thigh, y = upper_arm)) + 
  geom_point(alpha = 0.7) + 
  labs(title = "대퇴부 vs 상박부 산점도", 
       x = "대퇴부 둘레 (thigh, cm)", 
       y = "상박부 둘레 (upper_arm, cm)") + 
  theme_minimal()

model <- lm(upper_arm ~ thigh, data = train_data)
summary(model)

  residuals(model)





train_data <- read.csv("C:/Users/PC502/Desktop/simple_train_data.csv")
test_data <- read.csv("C:/Users/PC502/Desktop/simple_test_data.csv")

model <- lm(upper_arm ~ thigh, data = train_data)
summary(model)

saveRDS(model, "C:/Users/PC502/Desktop/regression_model.rds")

loaded_model <- readRDS("C:/Users/PC502/Desktop/regression_model.rds")

predicted <- predict(loaded_model, newdata = test_data)
head(predicted)



results <- data.frame(Actual = test_data$upper_arm, Predicted = predicted)

rmse <- sqrt(mean((results$Actual - results$Predicted)^2))
print(paste("RMSE:", round(rmse, 3)))

model <- lm(upper_arm ~ 0 + thigh, data = train_data)
summary(model)



install.packages("rstatix")
install.packages("skimr")
library(rstatix)
library(skimr)

df <- read.csv("C:/Users/PC502/Desktop/diabetes.csv", header = TRUE, na = ".", stringsAsFactors = TRUE)
skim(df)

df <- select(df, -c(var1, var2, var3))
df <- select(df, -c(SkinThickness, Insulin, Outcome))
skim(df)



result <- lm(df$Diabetes ~ ., data = df)
result1 <- lm(df$Diabetes ~ 1, data = df)

anova_result <- anova(result, result1)
print(anova_result)

summary(result)

saveRDS(model, "C:/Users/PC502/Desktop/regression_model.rds")

loaded_model <- readRDS("C:/Users/PC502/Desktop/regression_model.rds")



new_data <- read.csv("C:/Users/PC502/Desktop/diabetes_test.csv")

predicted <- predict(loaded_model, newdata = new_data)
head(predicted)

results <- data.frame(new_data, Predicted = predicted)

write.csv(results, "C:/Users/PC502/Desktop/predicted_values.csv", row.names = FALSE)



rmse <- sqrt
